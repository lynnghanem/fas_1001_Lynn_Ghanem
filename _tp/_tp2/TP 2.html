<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>TP 2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="TP 2_files/libs/clipboard/clipboard.min.js"></script>
<script src="TP 2_files/libs/quarto-html/quarto.js"></script>
<script src="TP 2_files/libs/quarto-html/popper.min.js"></script>
<script src="TP 2_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="TP 2_files/libs/quarto-html/anchor.min.js"></script>
<link href="TP 2_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="TP 2_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="TP 2_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="TP 2_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="TP 2_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">TP 2</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="limpact-du-pib-sur-la-satisfaction-des-individus-option-1" class="level1">
<h1>L’impact du PIB sur la satisfaction des individus (Option 1)</h1>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>La richesse d’un pays le rend-il véritablement plus heureux? La pauvreté est souvent désignée comme un des facteurs les plus déterminants du malheur. Plusieurs études montrent qu’il existe une corrélation positive entre le PIB et le taux de satisfaction au sein de la population, surtout au niveau des pays en développement qui vivent des croissances plus prononcées (Proto et Rustichini 2013).</p>
<p>L’étude suivante cherche à examiner le lien entre le PIB et le taux de satisfaction que les individus ont à l’égard de leurs vies au Canada. Les données utilisées sont tirées de Statistiques Canada. Aux fins de l’étude, les données de Statistiques Canada sur le Produit Intérieur Brut du pays seront croisées avec les résultats sur la satisfaction de vie de la Canadian Community Health Survey. Le croisement de ses donneés nous permettra de comparer l’évolution du PIB à celle de la satisfaction générale de la population entre 2015 et 2022.</p>
</section>
<section id="données-et-méthodes" class="level2">
<h2 class="anchored" data-anchor-id="données-et-méthodes">Données et méthodes</h2>
<p>Deux types de données sont donc utilisées dans ce travail : le PIB, une donnée économique, et la satisfaction à l’égard de la vie, une donnée qualitative tirée d’un sondage conduit par le gouvernement fédéral canadien dans le cadre d’une enquête sur la santé dans les collectivités canadiennes. Le PIB est mesuré en dollars. La satisfaction est mesurée selon une échelle allant de “pas satisfait du tout” (0) à “très satisfait.” (10) Les données utilisées dans ce travail se limitent au pourcentage de personnes ayant répondu “satisfait” ou ’très satisfait” à chaque année entre 2015 à 2022.</p>
<p>Les données étant plus ou moins désordonnées, un travail de nettoyage à été fait pour les rendre analysables. Pour les données sur la satisfaction, j’ai enlevé toutes les lignes et colonnes qui ne me seraient pas utiles, comme le nombre brut de répondants et les répétitions. J’ai également renommé la colonne REF_DATE à “Date” pour que les données soient compatibles avec celles du PIB. Pour celles-ci, j’ai filtré les colonnes pour ne garder que le PIB total et non son <em>breakdown</em> en différentes catégories. Ensuite, j’ai enlevé la colonne vide avant d’utiliser la commande pivot_longer pour pouvoir mettre les dates dans l’ordre suivi par la même colonne dans la première base de données.</p>
<p>Enfin, j’ai combiné les deux bases de données en fonction de leur variable commune, la date, pour pouvoir créer un graphe dépeignant le résultat de ma question de recherche.</p>
</section>
<section id="résultats" class="level2">
<h2 class="anchored" data-anchor-id="résultats">Résultats</h2>
<p><img src="graphique.png" class="img-fluid"></p>
<p>Le graphique montre qu’il existe une corrélation négative, quoique semblablement faible, entre le PIB et la satisfaction. En effet, on voit sur le graphe que le PIB le plus élevé est associé au taux de satisfaction le plus faible.</p>
<p>Il existe, évidemment, d’autres facteurs qui affectent le PIB et la satisfaction des individus. Au cours des dernières années, plusieurs évènements, dont la pandémie de la COVID-19 et la récession entrainée par celle-ci, ont sans doute réduit la satisfaction que les individus ressentaient par rapport à leurs vies.</p>
<p>Ces résultats étant plus ou moins contre-intuitifs, plusieurs questions se posent. Il faudrait d’abord aborder les limites de ce travail. Les données obtenues à partir du site public de Statistiques Canada sont très limitées, notamment dans le temps : l’information sur la satisfaction de vie ne remonte pas plus loin que 2015, ce qui limite les possibilités de trouver des résultats statistiquement significatifs. Ensuite, le PIB national, et non par habitant, est loin d’être le meilleur indicateur du niveau de vie des individus. Le Produit Intérieur Brut comprend lui-même des limites, connues de tous les étudiants en science politique ou économie : par exemple, il ne prend pas en considération les conditions de production (facteur qui affecte certainement la satisfaction des individus!). De plus, la notion de satisfaction est subjective, chose qui n’est pas reflétée par le sondage dont les données ont été tirées. Le concept de satisfaction varie de culture en culture et même de ménage en ménage. Il serait donc difficile de tirer des généralisations d’une étude pareille.</p>
</section>
<section id="bibliographie" class="level2">
<h2 class="anchored" data-anchor-id="bibliographie">Bibliographie</h2>
<p>Proto E, Rustichini A. 2013. “A Reassessment of the Relationship between GDP and Life Satisfaction.” <em>PLoS ONE</em> 8(11): e79358. https://doi.org/10.1371/journal.pone.0079358</p>
<p>Statistics Canada. Table 36-10-0434-03&nbsp; Gross domestic product (GDP) at basic prices, by industry, annual average (x 1,000,000).<a href="#0">https://doi.org/10.25318/3610043401-eng</a></p>
<p>Statistics Canada. <a href="https://www150.statcan.gc.ca/t1/tbl1/en/tv.action?pid=1310009605">Table 13-10-0096-05&nbsp; Life satisfaction, satisfied or very satisfied, by age group</a>. <a href="https://doi.org/10.25318/1310009601-eng" class="uri">https://doi.org/10.25318/1310009601-eng</a></p>
</section>
<section id="annexe" class="level2">
<h2 class="anchored" data-anchor-id="annexe">Annexe</h2>
<section id="code-utilisé" class="level3">
<h3 class="anchored" data-anchor-id="code-utilisé">Code utilisé</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.3     ✔ purrr     1.0.2
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ ggplot2   3.4.3     ✔ tibble    3.2.1
✔ lubridate 1.9.2     ✔ tidyr     1.3.0
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Importation des données</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>Satisfaction_population <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"LifeSatisfactionFull.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 96 Columns: 18
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (9): GEO, Age group, Sex, Indicators, Characteristics, UOM, SCALAR_FACTO...
dbl (5): REF_DATE, UOM_ID, SCALAR_ID, VALUE, DECIMALS
lgl (4): DGUID, STATUS, SYMBOL, TERMINATED

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>Données_PIB <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"GDP 2015 to 2022.csv"</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Nettoyage des données sur la satisfaction</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>Satisfaction_population_cleaned <span class="ot">&lt;-</span> Satisfaction_population <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Characteristics <span class="sc">==</span> <span class="st">"Percent"</span>, <span class="fu">grepl</span>(<span class="st">'Total'</span>, <span class="st">`</span><span class="at">Age group</span><span class="st">`</span>)) <span class="sc">%&gt;%</span> <span class="fu">select</span>(REF_DATE, GEO, <span class="st">`</span><span class="at">Age group</span><span class="st">`</span>, Sex, Indicators, Characteristics, VALUE) <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="st">"Date"</span> <span class="ot">=</span> REF_DATE)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Nettoyage des données sur le PIB</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>Données_PIB_cleaned <span class="ot">&lt;-</span> Données_PIB <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Seasonal.adjustment <span class="sc">==</span> <span class="st">"All industries"</span>) <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="st">"GDP Total"</span> <span class="ot">=</span> Seasonal.adjustment) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="st">"Colonne1"</span>) <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"Date"</span>, <span class="at">values_to =</span> <span class="st">"Yearly GDP"</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>Données_PIB_cleaned<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">sub</span>(<span class="st">"^X"</span>, <span class="st">""</span>, Données_PIB_cleaned<span class="sc">$</span>Date)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Unification des données</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>Merged_Data <span class="ot">&lt;-</span> <span class="fu">merge</span>(Données_PIB_cleaned, Satisfaction_population_cleaned, <span class="at">by =</span> <span class="st">"Date"</span>)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="co">#Graphique</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>graphique <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(Merged_Data) <span class="sc">+</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a> <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Yearly GDP</span><span class="st">`</span>, <span class="at">y =</span> VALUE) <span class="sc">+</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="st">"circle"</span>, <span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">colour =</span> <span class="st">"#112446"</span>) <span class="sc">+</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a> <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Lien entre le PIB et la satisfaction à l'égard de la vie"</span>, <span class="at">y =</span> <span class="st">"Satisfaction (%)"</span>, <span class="at">x =</span> <span class="st">"PIB"</span> )</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>graphique</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP-2_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"graphique.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
</div>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>